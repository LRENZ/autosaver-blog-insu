# å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ“¸ åŠŸèƒ½æ¦‚è¿°

é¡¹ç›®ç°å·²é›†æˆå®Œæ•´çš„å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½,æ”¯æŒåœ¨ä»¥ä¸‹åœ°æ–¹ä¸Šä¼ å›¾ç‰‡:
- âœ… åˆ›å»º/ç¼–è¾‘åšå®¢æ–‡ç«  (Cover Image)
- âœ… åˆ›å»º/ç¼–è¾‘ Popup (Popup Image)

## ğŸ¯ åŠŸèƒ½ç‰¹ç‚¹

### 1. ä¸Šä¼ æ–¹å¼
- **æ‹–æ‹½ä¸Šä¼ **: ç‚¹å‡»ä¸Šä¼ åŒºåŸŸé€‰æ‹©æ–‡ä»¶
- **å®æ—¶é¢„è§ˆ**: ä¸Šä¼ åç«‹å³æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
- **è¿›åº¦æŒ‡ç¤º**: æ˜¾ç¤ºä¸Šä¼ çŠ¶æ€ (Uploading...)
- **åŒé‡è¾“å…¥**: æ”¯æŒä¸Šä¼ æˆ–æ‰‹åŠ¨è¾“å…¥ URL

### 2. æ–‡ä»¶é™åˆ¶
- **æ”¯æŒæ ¼å¼**: JPEG, JPG, PNG, GIF, WebP
- **æœ€å¤§å¤§å°**: 5MB
- **è‡ªåŠ¨éªŒè¯**: è¶…å‡ºé™åˆ¶ä¼šæ˜¾ç¤ºé”™è¯¯æç¤º

### 3. ç”¨æˆ·ä½“éªŒ
- **å›¾ç‰‡é¢„è§ˆ**: ä¸Šä¼ åæ˜¾ç¤ºå®Œæ•´é¢„è§ˆ
- **æ‚¬åœåˆ é™¤**: é¼ æ ‡æ‚¬åœæ˜¾ç¤ºåˆ é™¤æŒ‰é’®
- **URL æ˜¾ç¤º**: æ˜¾ç¤ºå›¾ç‰‡çš„å®Œæ•´ URL
- **é”™è¯¯æç¤º**: æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯

## ğŸš€ æŠ€æœ¯å®ç°

### å­˜å‚¨æ–¹æ¡ˆ: Vercel Blob

**ä¸ºä»€ä¹ˆé€‰æ‹© Vercel Blob?**
- âœ… ä¸ Vercel å®Œç¾é›†æˆ
- âœ… æ— éœ€é¢å¤–é…ç½®
- âœ… è‡ªåŠ¨ CDN åŠ é€Ÿ
- âœ… ç®€å•æ˜“ç”¨çš„ API
- âœ… å…¬å…±è®¿é—® URL

### æ¶æ„è®¾è®¡

```
ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡
    â†“
ImageUpload ç»„ä»¶éªŒè¯ (ç±»å‹ã€å¤§å°)
    â†“
è°ƒç”¨ /api/upload API
    â†“
ä¸Šä¼ åˆ° Vercel Blob
    â†“
è¿”å›å…¬å…± URL
    â†“
æ˜¾ç¤ºé¢„è§ˆå¹¶ä¿å­˜ URL
```

## ğŸ“¦ æ–‡ä»¶ç»“æ„

```
webapp/
â”œâ”€â”€ app/api/upload/
â”‚   â””â”€â”€ route.ts              # å›¾ç‰‡ä¸Šä¼  API
â”œâ”€â”€ components/
â”‚   â””â”€â”€ ImageUpload.tsx       # å›¾ç‰‡ä¸Šä¼ ç»„ä»¶
â”œâ”€â”€ app/admin/posts/create/
â”‚   â””â”€â”€ page.tsx              # å·²é›†æˆä¸Šä¼ 
â”œâ”€â”€ app/admin/posts/edit/[id]/
â”‚   â””â”€â”€ page.tsx              # å·²é›†æˆä¸Šä¼ 
â””â”€â”€ components/admin/
    â””â”€â”€ PopupForm.tsx         # å·²é›†æˆä¸Šä¼ 
```

## ğŸ”§ é…ç½®è¯´æ˜

### 1. ç¯å¢ƒå˜é‡

åœ¨ Vercel éƒ¨ç½²æ—¶,éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡:

```bash
# Vercel Blob Token (è‡ªåŠ¨æä¾›)
BLOB_READ_WRITE_TOKEN=vercel_blob_xxx
```

**é‡è¦**: 
- åœ¨ Vercel ç”Ÿäº§ç¯å¢ƒ,è¿™ä¸ª token ä¼š**è‡ªåŠ¨æä¾›**
- åœ¨æœ¬åœ°å¼€å‘,éœ€è¦è¿è¡Œ: `vercel env pull .env.local`

### 2. Vercel Blob è®¾ç½®

#### åœ¨ Vercel Dashboard:
1. è¿›å…¥ä½ çš„é¡¹ç›®
2. ç‚¹å‡» "Storage" æ ‡ç­¾
3. åˆ›å»º "Blob" å­˜å‚¨
4. Token ä¼šè‡ªåŠ¨æ·»åŠ åˆ°ç¯å¢ƒå˜é‡

#### æœ¬åœ°å¼€å‘:
```bash
# 1. å®‰è£… Vercel CLI
npm i -g vercel

# 2. ç™»å½•
vercel login

# 3. å…³è”é¡¹ç›®
vercel link

# 4. æ‹‰å–ç¯å¢ƒå˜é‡
vercel env pull .env.local
```

## ğŸ’» ä½¿ç”¨ç¤ºä¾‹

### åœ¨è¡¨å•ä¸­ä½¿ç”¨

```tsx
import ImageUpload from '@/components/ImageUpload';

function MyForm() {
  const [imageUrl, setImageUrl] = useState('');

  return (
    <form>
      <ImageUpload
        label="å°é¢å›¾ç‰‡"
        value={imageUrl}
        onChange={(url) => setImageUrl(url)}
        required
      />
    </form>
  );
}
```

### Props è¯´æ˜

```tsx
interface ImageUploadProps {
  value?: string;           // å½“å‰å›¾ç‰‡ URL
  onChange: (url: string) => void;  // URL å˜åŒ–å›è°ƒ
  label?: string;           // æ ‡ç­¾æ–‡å­—
  required?: boolean;       // æ˜¯å¦å¿…å¡«
}
```

## ğŸ¨ UI ç»„ä»¶ç‰¹æ€§

### ä¸Šä¼ åŒºåŸŸ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚          [å›¾ç‰‡å›¾æ ‡]             â”‚
â”‚                                 â”‚
â”‚    Click to upload image        â”‚
â”‚  JPEG, PNG, GIF, WebP (max 5MB) â”‚
â”‚                                 â”‚
â”‚          [ä¸Šä¼ å›¾æ ‡]             â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¢„è§ˆçŠ¶æ€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚      [æ˜¾ç¤ºä¸Šä¼ çš„å›¾ç‰‡]            â”‚
â”‚                                 â”‚
â”‚  (æ‚¬åœæ˜¾ç¤ºåˆ é™¤æŒ‰é’®)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Image URL: https://...blob.vercel-storage.com/...
```

### ä¸Šä¼ ä¸­
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚      [æ—‹è½¬çš„åŠ è½½å›¾æ ‡]            â”‚
â”‚        Uploading...             â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š API ç«¯ç‚¹

### POST /api/upload

**ä¸Šä¼ å›¾ç‰‡**

```typescript
// Request
const formData = new FormData();
formData.append('file', file);

fetch('/api/upload', {
  method: 'POST',
  body: formData
});

// Response (Success)
{
  "success": true,
  "url": "https://xxx.blob.vercel-storage.com/xxx.jpg",
  "filename": "1234567890-abc123.jpg"
}

// Response (Error)
{
  "error": "File size too large. Maximum size is 5MB."
}
```

### éªŒè¯è§„åˆ™

1. **æ–‡ä»¶ç±»å‹**:
   ```typescript
   const validTypes = [
     'image/jpeg',
     'image/jpg', 
     'image/png',
     'image/gif',
     'image/webp'
   ];
   ```

2. **æ–‡ä»¶å¤§å°**:
   ```typescript
   const maxSize = 5 * 1024 * 1024; // 5MB
   ```

3. **æ–‡ä»¶åç”Ÿæˆ**:
   ```typescript
   const filename = `${timestamp}-${randomString}.${extension}`;
   // ä¾‹å¦‚: 1703001234567-abc123def.jpg
   ```

## ğŸ”’ å®‰å…¨æ€§

### å®¢æˆ·ç«¯éªŒè¯
- âœ… æ–‡ä»¶ç±»å‹æ£€æŸ¥
- âœ… æ–‡ä»¶å¤§å°é™åˆ¶
- âœ… å³æ—¶é”™è¯¯åé¦ˆ

### æœåŠ¡å™¨ç«¯éªŒè¯
- âœ… å†æ¬¡éªŒè¯æ–‡ä»¶ç±»å‹
- âœ… å†æ¬¡éªŒè¯æ–‡ä»¶å¤§å°
- âœ… ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å
- âœ… å…¬å…±è®¿é—®æƒé™æ§åˆ¶

### é”™è¯¯å¤„ç†
```typescript
try {
  await uploadImage();
} catch (error) {
  // æ˜¾ç¤ºç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯
  setError('Upload failed. Please try again.');
}
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. æ–‡ä»¶å‹ç¼©
å»ºè®®åœ¨ä¸Šä¼ å‰å‹ç¼©å¤§å›¾ç‰‡:
- ä½¿ç”¨åœ¨çº¿å·¥å…·: TinyPNG, Squoosh
- æˆ–è€…é›†æˆå®¢æˆ·ç«¯å‹ç¼©åº“

### 2. å›¾ç‰‡ä¼˜åŒ–
Next.js è‡ªåŠ¨ä¼˜åŒ–æ˜¾ç¤ºçš„å›¾ç‰‡:
```tsx
<Image
  src={imageUrl}
  alt="Preview"
  fill
  className="object-cover"
  unoptimized  // å¦‚æœæ˜¯å¤–éƒ¨ URL
/>
```

### 3. CDN åŠ é€Ÿ
Vercel Blob è‡ªåŠ¨æä¾› CDN:
- å…¨çƒåˆ†å‘
- è¾¹ç¼˜ç¼“å­˜
- å¿«é€Ÿè®¿é—®

## ğŸ› å¸¸è§é—®é¢˜

### Q1: ä¸Šä¼ å¤±è´¥,æ˜¾ç¤º "No BLOB_READ_WRITE_TOKEN"

**è§£å†³æ–¹æ¡ˆ**:
```bash
# åœ¨ Vercel Dashboard è®¾ç½® Blob å­˜å‚¨
# æˆ–æœ¬åœ°è¿è¡Œ:
vercel env pull .env.local
```

### Q2: å›¾ç‰‡ä¸Šä¼ æˆåŠŸä½†ä¸æ˜¾ç¤º

**æ£€æŸ¥**:
- âœ… æ£€æŸ¥ Console ä¸­çš„ URL
- âœ… ç¡®è®¤ URL å¯è®¿é—®
- âœ… æ£€æŸ¥ CORS è®¾ç½®

### Q3: ä¸Šä¼ å¾ˆæ…¢

**åŸå› **:
- å›¾ç‰‡å¤ªå¤§ (>5MB)
- ç½‘ç»œè¿æ¥æ…¢

**è§£å†³**:
- å‹ç¼©å›¾ç‰‡åä¸Šä¼ 
- æ£€æŸ¥ç½‘ç»œè¿æ¥

### Q4: æœ¬åœ°å¼€å‘æ— æ³•ä¸Šä¼ 

**è§£å†³**:
```bash
# 1. ç¡®ä¿å·²ç™»å½• Vercel
vercel login

# 2. å…³è”é¡¹ç›®
vercel link

# 3. æ‹‰å–ç¯å¢ƒå˜é‡
vercel env pull .env.local

# 4. é‡å¯å¼€å‘æœåŠ¡å™¨
npm run dev
```

## ğŸ¯ ä½¿ç”¨æµç¨‹

### åˆ›å»ºåšå®¢æ–‡ç« æ—¶ä¸Šä¼ å›¾ç‰‡

1. **è¿›å…¥åˆ›å»ºé¡µé¢**
   ```
   /admin/posts/create
   ```

2. **æ‰¾åˆ°å°é¢å›¾ç‰‡åŒºåŸŸ**
   - çœ‹åˆ°ä¸Šä¼ åŒºåŸŸå’Œ"Click to upload image"

3. **ä¸Šä¼ å›¾ç‰‡**
   - ç‚¹å‡»ä¸Šä¼ åŒºåŸŸ
   - é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ (JPEG/PNG/GIF/WebP, <5MB)
   - ç­‰å¾…ä¸Šä¼ å®Œæˆ

4. **ç¡®è®¤ä¸Šä¼ **
   - çœ‹åˆ°å›¾ç‰‡é¢„è§ˆ
   - URL æ˜¾ç¤ºåœ¨ä¸‹æ–¹
   - å¯ä»¥æ‚¬åœåˆ é™¤é‡æ–°ä¸Šä¼ 

5. **ä¿å­˜æ–‡ç« **
   - å¡«å†™å…¶ä»–å­—æ®µ
   - ç‚¹å‡» "Create Post"
   - å›¾ç‰‡ URL è‡ªåŠ¨ä¿å­˜

### ç¼–è¾‘æ–‡ç« æ—¶æ›´æ¢å›¾ç‰‡

1. **è¿›å…¥ç¼–è¾‘é¡µé¢**
   ```
   /admin/posts/edit/[id]
   ```

2. **æŸ¥çœ‹å½“å‰å›¾ç‰‡**
   - æ˜¾ç¤ºç°æœ‰çš„å°é¢å›¾

3. **æ›´æ¢å›¾ç‰‡**
   - æ‚¬åœåœ¨å›¾ç‰‡ä¸Š
   - ç‚¹å‡»åˆ é™¤æŒ‰é’® (X)
   - é‡æ–°ä¸Šä¼ æ–°å›¾ç‰‡

4. **ä¿å­˜æ›´æ”¹**
   - ç‚¹å‡» "Update Post"

## ğŸ“± å“åº”å¼è®¾è®¡

ä¸Šä¼ ç»„ä»¶åœ¨æ‰€æœ‰è®¾å¤‡ä¸Šéƒ½èƒ½å®Œç¾å·¥ä½œ:

- **æ¡Œé¢ç«¯**: å®Œæ•´çš„æ‹–æ‹½å’Œé¢„è§ˆ
- **å¹³æ¿ç«¯**: è§¦æ‘¸å‹å¥½çš„ç•Œé¢
- **æ‰‹æœºç«¯**: ä¼˜åŒ–çš„è§¦æ‘¸ä½“éªŒ

## ğŸ”„ å¤‡ç”¨æ–¹æ¡ˆ

å¦‚æœä¸æƒ³ä½¿ç”¨ Vercel Blob,ä¹Ÿå¯ä»¥æ‰‹åŠ¨è¾“å…¥å›¾ç‰‡ URL:

1. **ä¸Šä¼ åˆ°å…¶ä»–æœåŠ¡**:
   - Cloudinary
   - Imgur
   - AWS S3
   - ä»»ä½•å›¾åºŠæœåŠ¡

2. **å¤åˆ¶å›¾ç‰‡ URL**

3. **ç²˜è´´åˆ°"Or enter image URL manually"å­—æ®µ**

4. **ä¿å­˜**

## ğŸ“š ç›¸å…³èµ„æº

- [Vercel Blob Documentation](https://vercel.com/docs/storage/vercel-blob)
- [Next.js Image Optimization](https://nextjs.org/docs/app/building-your-application/optimizing/images)
- [File Upload Best Practices](https://developer.mozilla.org/en-US/docs/Web/API/File_API)

## âœ… åŠŸèƒ½æ¸…å•

- [x] å›¾ç‰‡ä¸Šä¼  API
- [x] ImageUpload ç»„ä»¶
- [x] æ–‡ä»¶ç±»å‹éªŒè¯
- [x] æ–‡ä»¶å¤§å°éªŒè¯
- [x] å®æ—¶é¢„è§ˆ
- [x] ä¸Šä¼ è¿›åº¦
- [x] é”™è¯¯å¤„ç†
- [x] åˆ é™¤åŠŸèƒ½
- [x] URL æ˜¾ç¤º
- [x] é›†æˆåˆ° Post è¡¨å•
- [x] é›†æˆåˆ° Popup è¡¨å•
- [x] å“åº”å¼è®¾è®¡
- [x] å¤‡ç”¨æ‰‹åŠ¨è¾“å…¥

## ğŸ‰ æ€»ç»“

å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½å·²å®Œå…¨é›†æˆåˆ°é¡¹ç›®ä¸­,æä¾›äº†:
- ğŸš€ ç®€å•æ˜“ç”¨çš„ä¸Šä¼ ç•Œé¢
- ğŸ”’ å®Œå–„çš„å®‰å…¨éªŒè¯
- ğŸ“¦ å¯é çš„å­˜å‚¨æ–¹æ¡ˆ
- ğŸ¨ ç¾è§‚çš„ UI è®¾è®¡
- ğŸ“± å…¨è®¾å¤‡æ”¯æŒ

ç°åœ¨å¯ä»¥åœ¨ç®¡ç†åå°è½»æ¾ä¸Šä¼ å’Œç®¡ç†å›¾ç‰‡äº†! ğŸŠ
